@import "../../config";
@import "../../dependencies/index";

.#{$css-prefix}table {
  // scss-lint:disable SelectorDepth
  background-color: $color-background-alt;

  // Cells
  th,
  td {
    padding: $spacing-x-small;
    white-space: nowrap;
    position: relative;
  }

  // Table Heading Cells
  th {
    font-weight: $font-weight-regular;
  }

  // Default Table Row Hover
  &:not(.#{$css-prefix}no-row-hover) tbody tr:hover {
    > td,
    > th {
      background-color: $color-background-row-hover;
    }
  }

  // Selected Table Row + Hover
  tbody tr.#{$css-prefix}is-selected,
  &:not(.#{$css-prefix}no-row-hover) tr.#{$css-prefix}is-selected:hover {

    > td,
    > th {
      background-color: $color-background-row-selected;
    }
  }

  // By default, nowrap is applied
  .#{$css-prefix}cell-wrap {
    white-space: normal;
  }

  // Reduce cell to the width of its content, if space is available
  .#{$css-prefix}cell-shrink {
    width: 1%;
  }

  // Use to add a left padding buffer to cells, @todo will need to reset for responsive
  .#{$css-prefix}cell-buffer--left {
    padding-left: $spacing-large;
  }

  .#{$css-prefix}cell-buffer--right {
    padding-right: $spacing-large;
  }
}

// Add left and right padding to the first and last cells of a table
.#{$css-prefix}table--cell-buffer {

  tr > th:first-child,
  tr > td:first-child {
    padding-left: $spacing-large;
  }

  tr > th:last-child,
  tr > td:last-child {
    padding-right: $spacing-large;
  }
}

// Add vertical borders to a table
.#{$css-prefix}table--bordered {
  // scss-lint:disable SelectorDepth
  border: {
    top: $border-width-thin solid $color-border;
    bottom: $border-width-thin solid $color-border;
  }

  // More than one row in thead
  thead > tr + tr > th {
    border-top: $border-width-thin solid $color-border;
  }

  // Cells
  tbody td,
  tbody th {
    border-top: $border-width-thin solid $color-border;
  }

  // Default Table Row Hover
  //
  // Checks if .no-row-hover is applied to parent table
  // Applies hovers to only <th> and <td> within <tbody>
  // Also checks that the <th> and <td> do not have the class .is-selected
  // This retains the selected state when a row is hovered
  //
  // Box shadow used to eliminate jumpiness on hover
  &:not(.#{$css-prefix}no-row-hover) tbody tr:hover > td:not(.#{$css-prefix}is-selected),
  &:not(.#{$css-prefix}no-row-hover) tbody tr:hover > th:not(.#{$css-prefix}is-selected) {
    box-shadow: $color-border 0 ($border-width-thin * -1) 0 inset,
                $color-border 0 ($border-width-thin) 0 inset;
  }
}

// Add column borders
.#{$css-prefix}table--col-bordered {

  td + td,
  th + th,
  th + td,
  td + th {
    border-left: $border-width-thin solid $color-border;
  }
}

// Add alternating strips to rows
.#{$css-prefix}table--striped {
  // scss-lint:disable SelectorDepth
  tbody tr:nth-of-type(even) > td,
  tbody tr:nth-of-type(even) > th {
    background-color: $color-background-row-hover;
  }
}

// Applies move cursor to moveable cell
th.#{$css-prefix}is-sortable {
  cursor: pointer;
  padding: 0; // Reset padding so actionable link bleeds to edge

}

// Actionable area inside th
.#{$css-prefix}th__action {
  display: flex;
  padding: $spacing-x-small;

  &:focus,
  &:hover {
    outline: 0;
    background-color: $color-background-row-hover;

    .#{$css-prefix}is-sortable__icon {
      display: inline-block;
    }
  }
}

// Icon inside sortable th
.#{$css-prefix}is-sortable__icon {
  @include square($square-icon-small-content);
  margin-left: $spacing-xx-small;
  display: none;
}

// Active state of sorted column
.#{$css-prefix}is-sorted {

  .#{$css-prefix}is-sortable__icon {
    display: inline-block;
  }

  // Change direction of arrow
  &--asc .#{$css-prefix}is-sortable__icon {
    transform: rotate(180deg);
  }
}

// Provide an indicator that resizing is available
.#{$css-prefix}is-resizable {

  .#{$css-prefix}th__action:hover,
  .#{$css-prefix}th__action:focus {
    box-shadow: $color-border-separator-alt ($spacing-xx-small * -1) 0 0 inset;
  }
}

// Resizable handle
.#{$css-prefix}resizable {
  max-width: 100%;

  &__handle {
    position: absolute;
    right: 0;
    top: 0;
    width: $spacing-xx-small;
    height: 100%;
    background: $color-background-button-brand;
    display: block;
    cursor: col-resize;
    opacity: 0;
    z-index: $z-index-popup;

    &:hover,
    &:focus,
    &:active {
      opacity: 1;
    }
  }

  &__divider {
    position: absolute;
    right: 0;
    height: 100vh;
    width: 1px;
    background: $color-background-button-brand;
  }

  &__input:focus ~ .#{$css-prefix}resizable__handle {
    opacity: 1;
  }
}

// Resizable data table columns
//
// Set table to use fixed layout for width and truncation purposes
.#{$css-prefix}table--fixed-layout {
  table-layout: fixed;
  width: 100%;
  white-space: nowrap;

  thead {
    background-color: $color-background-alt;
  }

  .#{$css-prefix}cell-shrink {
    width: $square-icon-large-boundary;

    &:nth-child(n) {
      padding: {
        left: 0;
        right: 0;
      }
    }

    &:first-child {
      text-align: right;
      padding-right: $spacing-x-small;
    }

    &:last-child {
      text-align: left;
      padding-left: $spacing-x-small;
    }
  }
}

.#{$css-prefix}table--compact {

  th,
  td {
    padding: $spacing-xx-small $spacing-x-small;
  }
}

.#{$css-prefix}table--header-fixed_container {
  position: relative;
  padding-top: 2rem; // This matches the height of the hover state w/border
  border-top: $border-width-thin solid $color-border;
  background-color: $color-background-alt;
  background-image: linear-gradient(
                  to bottom,
                  $color-background-alt,
                  $color-background-alt 1.9375rem,
                  $color-border 1.9375rem,
                  $color-border 2rem,
                  $color-background-alt 2rem,
                  $color-background-alt
  ); // Creates line below th for faux fixed headers
}

.#{$css-prefix}cell-fixed {
  position: absolute;
  top: 0;
  min-height: 2rem;
}

.#{$css-prefix}table--header-fixed {
  border-top: 0;

  thead th {
    position: static;
    border-top: 0;
  }

  tbody tr:first-child { // Remove first border row due to faux th border
    // scss-lint:disable SelectorDepth
    td,
    th {
      border: 0;
    }
  }
}
